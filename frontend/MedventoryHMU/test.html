<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n l√Ω Trang thi·∫øt b·ªã Y t·∫ø - BVƒêHYHN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            box-sizing: border-box;
        }
        .medical-gradient {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.1), 0 2px 4px -1px rgba(59, 130, 246, 0.06);
        }
    </style>
</head>
<body class="medical-gradient min-h-screen font-sans">
    <!-- Header -->
    <header class="bg-white shadow-lg border-b-4 border-blue-600">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">Qu·∫£n l√Ω Trang thi·∫øt b·ªã Y t·∫ø</h1>
                        <p class="text-sm text-blue-600 font-medium">B·ªánh vi·ªán ƒê·∫°i h·ªçc Y H√† N·ªôi</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <p class="text-sm font-medium text-gray-900">BS. Nguy·ªÖn VƒÉn An</p>
                        <p class="text-xs text-blue-600">Tr∆∞·ªüng khoa Thi·∫øt b·ªã Y t·∫ø</p>
                    </div>
                    <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                        <span class="text-blue-600 font-semibold">NA</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Navigation Tabs -->
        <div class="mb-8">
            <nav class="flex space-x-8">
                <button onclick="showTab('dashboard')" id="tab-dashboard" class="tab-button active px-4 py-2 text-sm font-medium rounded-lg transition-colors">
                    üìä T·ªïng quan
                </button>
                <button onclick="showTab('equipment')" id="tab-equipment" class="tab-button px-4 py-2 text-sm font-medium rounded-lg transition-colors">
                    üè• Danh s√°ch thi·∫øt b·ªã
                </button>
                <button onclick="showTab('add')" id="tab-add" class="tab-button px-4 py-2 text-sm font-medium rounded-lg transition-colors">
                    ‚ûï Th√™m thi·∫øt b·ªã
                </button>
                <button onclick="showTab('export')" id="tab-export" class="tab-button px-4 py-2 text-sm font-medium rounded-lg transition-colors">
                    üì§ Xu·∫•t thi·∫øt b·ªã
                </button>
            </nav>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard-content" class="tab-content">
            <!-- Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-xl p-6 card-shadow">
                    <div class="flex items-center">
                        <div class="p-3 rounded-full bg-blue-100">
                            <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-600">T·ªïng thi·∫øt b·ªã</p>
                            <p class="text-2xl font-bold text-gray-900" id="total-equipment">156</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl p-6 card-shadow">
                    <div class="flex items-center">
                        <div class="p-3 rounded-full bg-green-100">
                            <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-600">Ho·∫°t ƒë·ªông t·ªët</p>
                            <p class="text-2xl font-bold text-green-600" id="working-equipment">142</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl p-6 card-shadow">
                    <div class="flex items-center">
                        <div class="p-3 rounded-full bg-yellow-100">
                            <svg class="w-6 h-6 text-yellow-600" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-600">C·∫ßn b·∫£o tr√¨</p>
                            <p class="text-2xl font-bold text-yellow-600" id="maintenance-equipment">8</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl p-6 card-shadow">
                    <div class="flex items-center">
                        <div class="p-3 rounded-full bg-red-100">
                            <svg class="w-6 h-6 text-red-600" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-600">H·ªèng h√≥c</p>
                            <p class="text-2xl font-bold text-red-600" id="broken-equipment">6</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts and Activities -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Status Chart -->
                <div class="bg-white rounded-xl p-6 card-shadow">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Ph√¢n b·ªë theo tr·∫°ng th√°i</h3>
                    <div class="h-64 flex items-center justify-center">
                        <canvas id="statusChart" width="300" height="300"></canvas>
                    </div>
                </div>

                <!-- Recent Activities -->
                <div class="bg-white rounded-xl p-6 card-shadow">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y</h3>
                    <div class="space-y-4">
                        <div class="flex items-center p-3 bg-blue-50 rounded-lg">
                            <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                            <span class="text-sm text-gray-700">Th√™m m·ªõi thi·∫øt b·ªã TB005 - M√°y x√©t nghi·ªám m√°u</span>
                            <span class="ml-auto text-xs text-gray-500">2 gi·ªù tr∆∞·ªõc</span>
                        </div>
                        <div class="flex items-center p-3 bg-yellow-50 rounded-lg">
                            <div class="w-2 h-2 bg-yellow-500 rounded-full mr-3"></div>
                            <span class="text-sm text-gray-700">C·∫≠p nh·∫≠t tr·∫°ng th√°i TB003 - C·∫ßn b·∫£o tr√¨</span>
                            <span class="ml-auto text-xs text-gray-500">1 ng√†y tr∆∞·ªõc</span>
                        </div>
                        <div class="flex items-center p-3 bg-green-50 rounded-lg">
                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                            <span class="text-sm text-gray-700">Ho√†n th√†nh b·∫£o tr√¨ TB002 - M√°y si√™u √¢m</span>
                            <span class="ml-auto text-xs text-gray-500">3 ng√†y tr∆∞·ªõc</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Equipment List Tab -->
        <div id="equipment-content" class="tab-content hidden">
            <div class="bg-white rounded-xl card-shadow">
                <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                    <h3 class="text-lg font-semibold text-gray-900">Danh s√°ch Trang thi·∫øt b·ªã Y t·∫ø</h3>
                    <div class="flex space-x-3">
                        <button onclick="exportData()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                            üì§ Xu·∫•t Excel
                        </button>
                        <select class="border border-gray-300 rounded-lg px-3 py-2 text-sm" onchange="filterByStatus(this.value)">
                            <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                            <option value="Ho·∫°t ƒë·ªông t·ªët">Ho·∫°t ƒë·ªông t·ªët</option>
                            <option value="C·∫ßn b·∫£o tr√¨">C·∫ßn b·∫£o tr√¨</option>
                            <option value="H·ªèng h√≥c">H·ªèng h√≥c</option>
                        </select>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">M√£ TB</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">T√™n thi·∫øt b·ªã</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Khoa ph√≤ng</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tr·∫°ng th√°i</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ng√†y mua</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody id="equipment-table" class="bg-white divide-y divide-gray-200">
                            <!-- Equipment data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Add Equipment Tab -->
        <div id="add-content" class="tab-content hidden">
            <div class="bg-white rounded-xl p-6 card-shadow max-w-2xl">
                <h3 class="text-lg font-semibold text-gray-900 mb-6">Th√™m Trang thi·∫øt b·ªã Y t·∫ø m·ªõi</h3>
                <form id="add-equipment-form" onsubmit="addEquipment(event)" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">M√£ thi·∫øt b·ªã</label>
                            <input type="text" id="equipment-code" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">T√™n thi·∫øt b·ªã</label>
                            <input type="text" id="equipment-name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Khoa ph√≤ng</label>
                            <select id="equipment-department" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Ch·ªçn khoa ph√≤ng</option>
                                <option value="Khoa N·ªôi">Khoa N·ªôi</option>
                                <option value="Khoa Ngo·∫°i">Khoa Ngo·∫°i</option>
                                <option value="Khoa S·∫£n">Khoa S·∫£n</option>
                                <option value="Khoa Nhi">Khoa Nhi</option>
                                <option value="Khoa C·∫•p c·ª©u">Khoa C·∫•p c·ª©u</option>
                                <option value="Khoa X√©t nghi·ªám">Khoa X√©t nghi·ªám</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tr·∫°ng th√°i</label>
                            <select id="equipment-status" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Ch·ªçn tr·∫°ng th√°i</option>
                                <option value="Ho·∫°t ƒë·ªông t·ªët">Ho·∫°t ƒë·ªông t·ªët</option>
                                <option value="C·∫ßn b·∫£o tr√¨">C·∫ßn b·∫£o tr√¨</option>
                                <option value="H·ªèng h√≥c">H·ªèng h√≥c</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ng√†y mua</label>
                            <input type="date" id="equipment-date" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Gi√° tr·ªã (VNƒê)</label>
                            <input type="number" id="equipment-value" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Ghi ch√∫</label>
                        <textarea id="equipment-notes" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                    </div>
                    <div class="flex justify-end space-x-3">
                        <button type="button" onclick="resetForm()" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                            H·ªßy
                        </button>
                        <button type="submit" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                            Th√™m thi·∫øt b·ªã
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Export Equipment Tab -->
        <div id="export-content" class="tab-content hidden">
            <div class="bg-white rounded-xl p-6 card-shadow">
                <h3 class="text-lg font-semibold text-gray-900 mb-6">Xu·∫•t d·ªØ li·ªáu Trang thi·∫øt b·ªã Y t·∫ø</h3>
                
                <!-- Export Options -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Export Filters -->
                    <div class="space-y-6">
                        <h4 class="text-md font-medium text-gray-900">T√πy ch·ªçn xu·∫•t d·ªØ li·ªáu</h4>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">L·ªçc theo khoa ph√≤ng</label>
                            <select id="export-department" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">T·∫•t c·∫£ khoa ph√≤ng</option>
                                <option value="Khoa N·ªôi">Khoa N·ªôi</option>
                                <option value="Khoa Ngo·∫°i">Khoa Ngo·∫°i</option>
                                <option value="Khoa S·∫£n">Khoa S·∫£n</option>
                                <option value="Khoa Nhi">Khoa Nhi</option>
                                <option value="Khoa C·∫•p c·ª©u">Khoa C·∫•p c·ª©u</option>
                                <option value="Khoa X√©t nghi·ªám">Khoa X√©t nghi·ªám</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">L·ªçc theo tr·∫°ng th√°i</label>
                            <select id="export-status" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                                <option value="Ho·∫°t ƒë·ªông t·ªët">Ho·∫°t ƒë·ªông t·ªët</option>
                                <option value="C·∫ßn b·∫£o tr√¨">C·∫ßn b·∫£o tr√¨</option>
                                <option value="H·ªèng h√≥c">H·ªèng h√≥c</option>
                            </select>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">T·ª´ ng√†y</label>
                                <input type="date" id="export-date-from" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ƒê·∫øn ng√†y</label>
                                <input type="date" id="export-date-to" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-3">ƒê·ªãnh d·∫°ng xu·∫•t</label>
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="radio" name="export-format" value="excel" checked class="text-blue-600 focus:ring-blue-500">
                                    <span class="ml-2 text-sm text-gray-700">üìä Excel (.xlsx)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="export-format" value="csv" class="text-blue-600 focus:ring-blue-500">
                                    <span class="ml-2 text-sm text-gray-700">üìÑ CSV (.csv)</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="radio" name="export-format" value="pdf" class="text-blue-600 focus:ring-blue-500">
                                    <span class="ml-2 text-sm text-gray-700">üìã PDF (.pdf)</span>
                                </label>
                            </div>
                        </div>

                        <div class="flex space-x-3">
                            <button onclick="previewExport()" class="flex-1 px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors">
                                üëÅÔ∏è Xem tr∆∞·ªõc
                            </button>
                            <button onclick="exportFilteredData()" class="flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                                üì§ Xu·∫•t d·ªØ li·ªáu
                            </button>
                        </div>
                    </div>

                    <!-- Export Statistics -->
                    <div class="space-y-6">
                        <h4 class="text-md font-medium text-gray-900">Th·ªëng k√™ d·ªØ li·ªáu xu·∫•t</h4>
                        
                        <div class="bg-gray-50 rounded-lg p-4 space-y-3">
                            <div class="flex justify-between">
                                <span class="text-sm text-gray-600">T·ªïng s·ªë thi·∫øt b·ªã:</span>
                                <span class="text-sm font-medium text-gray-900" id="export-total">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm text-gray-600">Ho·∫°t ƒë·ªông t·ªët:</span>
                                <span class="text-sm font-medium text-green-600" id="export-working">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm text-gray-600">C·∫ßn b·∫£o tr√¨:</span>
                                <span class="text-sm font-medium text-yellow-600" id="export-maintenance">0</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm text-gray-600">H·ªèng h√≥c:</span>
                                <span class="text-sm font-medium text-red-600" id="export-broken">0</span>
                            </div>
                        </div>

                        <!-- Quick Export Templates -->
                        <div>
                            <h5 class="text-sm font-medium text-gray-900 mb-3">M·∫´u xu·∫•t nhanh</h5>
                            <div class="space-y-2">
                                <button onclick="quickExport('all')" class="w-full text-left px-3 py-2 text-sm bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors">
                                    üìä T·∫•t c·∫£ thi·∫øt b·ªã
                                </button>
                                <button onclick="quickExport('maintenance')" class="w-full text-left px-3 py-2 text-sm bg-yellow-50 hover:bg-yellow-100 rounded-lg transition-colors">
                                    ‚ö†Ô∏è Thi·∫øt b·ªã c·∫ßn b·∫£o tr√¨
                                </button>
                                <button onclick="quickExport('broken')" class="w-full text-left px-3 py-2 text-sm bg-red-50 hover:bg-red-100 rounded-lg transition-colors">
                                    üîß Thi·∫øt b·ªã h·ªèng h√≥c
                                </button>
                                <button onclick="quickExport('monthly')" class="w-full text-left px-3 py-2 text-sm bg-green-50 hover:bg-green-100 rounded-lg transition-colors">
                                    üìÖ B√°o c√°o th√°ng n√†y
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Preview Table -->
                <div id="export-preview" class="mt-8 hidden">
                    <h4 class="text-md font-medium text-gray-900 mb-4">Xem tr∆∞·ªõc d·ªØ li·ªáu xu·∫•t</h4>
                    <div class="bg-gray-50 rounded-lg p-4 max-h-96 overflow-auto">
                        <table class="min-w-full text-sm">
                            <thead class="bg-white">
                                <tr>
                                    <th class="px-3 py-2 text-left font-medium text-gray-900">M√£ TB</th>
                                    <th class="px-3 py-2 text-left font-medium text-gray-900">T√™n thi·∫øt b·ªã</th>
                                    <th class="px-3 py-2 text-left font-medium text-gray-900">Khoa ph√≤ng</th>
                                    <th class="px-3 py-2 text-left font-medium text-gray-900">Tr·∫°ng th√°i</th>
                                    <th class="px-3 py-2 text-left font-medium text-gray-900">Ng√†y mua</th>
                                </tr>
                            </thead>
                            <tbody id="export-preview-table" class="divide-y divide-gray-200">
                                <!-- Preview data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample data
        let equipmentData = [
            {id: 1, code: 'TB001', name: 'M√°y X-quang', department: 'Khoa N·ªôi', status: 'Ho·∫°t ƒë·ªông t·ªët', date: '2023-01-15', value: 500000000},
            {id: 2, code: 'TB002', name: 'M√°y si√™u √¢m', department: 'Khoa S·∫£n', status: 'Ho·∫°t ƒë·ªông t·ªët', date: '2023-02-20', value: 300000000},
            {id: 3, code: 'TB003', name: 'M√°y th·ªü', department: 'Khoa C·∫•p c·ª©u', status: 'C·∫ßn b·∫£o tr√¨', date: '2022-12-10', value: 800000000},
            {id: 4, code: 'TB004', name: 'M√°y ECG', department: 'Khoa N·ªôi', status: 'H·ªèng h√≥c', date: '2023-03-05', value: 150000000},
            {id: 5, code: 'TB005', name: 'M√°y x√©t nghi·ªám m√°u', department: 'Khoa X√©t nghi·ªám', status: 'Ho·∫°t ƒë·ªông t·ªët', date: '2023-01-30', value: 400000000}
        ];

        let nextId = 6;

        // Tab functionality
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active', 'bg-blue-600', 'text-white');
                button.classList.add('text-gray-600', 'hover:text-blue-600');
            });
            
            // Show selected tab content
            document.getElementById(tabName + '-content').classList.remove('hidden');
            
            // Add active class to selected tab
            const activeTab = document.getElementById('tab-' + tabName);
            activeTab.classList.add('active', 'bg-blue-600', 'text-white');
            activeTab.classList.remove('text-gray-600', 'hover:text-blue-600');

            if (tabName === 'dashboard') {
                updateDashboard();
            } else if (tabName === 'equipment') {
                renderEquipmentTable();
            } else if (tabName === 'export') {
                updateExportStats();
            }
        }

        // Initialize dashboard
        function updateDashboard() {
            const total = equipmentData.length;
            const working = equipmentData.filter(eq => eq.status === 'Ho·∫°t ƒë·ªông t·ªët').length;
            const maintenance = equipmentData.filter(eq => eq.status === 'C·∫ßn b·∫£o tr√¨').length;
            const broken = equipmentData.filter(eq => eq.status === 'H·ªèng h√≥c').length;

            document.getElementById('total-equipment').textContent = total;
            document.getElementById('working-equipment').textContent = working;
            document.getElementById('maintenance-equipment').textContent = maintenance;
            document.getElementById('broken-equipment').textContent = broken;

            // Update chart
            updateStatusChart();
        }

        // Update status chart
        function updateStatusChart() {
            const working = equipmentData.filter(eq => eq.status === 'Ho·∫°t ƒë·ªông t·ªët').length;
            const maintenance = equipmentData.filter(eq => eq.status === 'C·∫ßn b·∫£o tr√¨').length;
            const broken = equipmentData.filter(eq => eq.status === 'H·ªèng h√≥c').length;

            const ctx = document.getElementById('statusChart').getContext('2d');
            
            // Destroy existing chart if it exists
            if (window.statusChartInstance) {
                window.statusChartInstance.destroy();
            }
            
            window.statusChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Ho·∫°t ƒë·ªông t·ªët', 'C·∫ßn b·∫£o tr√¨', 'H·ªèng h√≥c'],
                    datasets: [{
                        data: [working, maintenance, broken],
                        backgroundColor: ['#10B981', '#F59E0B', '#EF4444'],
                        borderWidth: 3,
                        borderColor: '#ffffff',
                        hoverBorderWidth: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${label}: ${value} thi·∫øt b·ªã (${percentage}%)`;
                                }
                            }
                        }
                    },
                    cutout: '60%'
                }
            });
        }

        // Render equipment table
        function renderEquipmentTable(filteredData = null) {
            const data = filteredData || equipmentData;
            const tbody = document.getElementById('equipment-table');
            
            tbody.innerHTML = data.map(equipment => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${equipment.code}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${equipment.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${equipment.department}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(equipment.status)}">
                            ${equipment.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${equipment.date}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editEquipment(${equipment.id})" class="text-blue-600 hover:text-blue-900 mr-3">S·ª≠a</button>
                        <button onclick="deleteEquipment(${equipment.id})" class="text-red-600 hover:text-red-900">X√≥a</button>
                    </td>
                </tr>
            `).join('');
        }

        function getStatusColor(status) {
            switch(status) {
                case 'Ho·∫°t ƒë·ªông t·ªët': return 'bg-green-100 text-green-800';
                case 'C·∫ßn b·∫£o tr√¨': return 'bg-yellow-100 text-yellow-800';
                case 'H·ªèng h√≥c': return 'bg-red-100 text-red-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        // Filter by status
        function filterByStatus(status) {
            if (status === '') {
                renderEquipmentTable();
            } else {
                const filtered = equipmentData.filter(eq => eq.status === status);
                renderEquipmentTable(filtered);
            }
        }

        // Add equipment
        function addEquipment(event) {
            event.preventDefault();
            
            const newEquipment = {
                id: nextId++,
                code: document.getElementById('equipment-code').value,
                name: document.getElementById('equipment-name').value,
                department: document.getElementById('equipment-department').value,
                status: document.getElementById('equipment-status').value,
                date: document.getElementById('equipment-date').value,
                value: parseInt(document.getElementById('equipment-value').value)
            };
            
            equipmentData.push(newEquipment);
            resetForm();
            alert('Th√™m thi·∫øt b·ªã th√†nh c√¥ng!');
            showTab('equipment');
        }

        // Reset form
        function resetForm() {
            document.getElementById('add-equipment-form').reset();
        }

        // Export data
        function exportData() {
            alert('Ch·ª©c nƒÉng xu·∫•t Excel ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn!');
        }

        // Edit equipment
        function editEquipment(id) {
            alert(`Ch·ªânh s·ª≠a thi·∫øt b·ªã ID: ${id}`);
        }

        // Delete equipment
        function deleteEquipment(id) {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a thi·∫øt b·ªã n√†y?')) {
                equipmentData = equipmentData.filter(eq => eq.id !== id);
                renderEquipmentTable();
                updateDashboard();
                alert('X√≥a thi·∫øt b·ªã th√†nh c√¥ng!');
            }
        }

        // Export functions
        function updateExportStats() {
            const filteredData = getFilteredExportData();
            const total = filteredData.length;
            const working = filteredData.filter(eq => eq.status === 'Ho·∫°t ƒë·ªông t·ªët').length;
            const maintenance = filteredData.filter(eq => eq.status === 'C·∫ßn b·∫£o tr√¨').length;
            const broken = filteredData.filter(eq => eq.status === 'H·ªèng h√≥c').length;

            document.getElementById('export-total').textContent = total;
            document.getElementById('export-working').textContent = working;
            document.getElementById('export-maintenance').textContent = maintenance;
            document.getElementById('export-broken').textContent = broken;
        }

        function getFilteredExportData() {
            let filtered = [...equipmentData];
            
            const department = document.getElementById('export-department').value;
            const status = document.getElementById('export-status').value;
            const dateFrom = document.getElementById('export-date-from').value;
            const dateTo = document.getElementById('export-date-to').value;

            if (department) {
                filtered = filtered.filter(eq => eq.department === department);
            }
            
            if (status) {
                filtered = filtered.filter(eq => eq.status === status);
            }
            
            if (dateFrom) {
                filtered = filtered.filter(eq => eq.date >= dateFrom);
            }
            
            if (dateTo) {
                filtered = filtered.filter(eq => eq.date <= dateTo);
            }

            return filtered;
        }

        function previewExport() {
            const filteredData = getFilteredExportData();
            const previewDiv = document.getElementById('export-preview');
            const tbody = document.getElementById('export-preview-table');
            
            tbody.innerHTML = filteredData.map(equipment => `
                <tr class="bg-white">
                    <td class="px-3 py-2 text-gray-900">${equipment.code}</td>
                    <td class="px-3 py-2 text-gray-900">${equipment.name}</td>
                    <td class="px-3 py-2 text-gray-900">${equipment.department}</td>
                    <td class="px-3 py-2">
                        <span class="px-2 py-1 text-xs rounded-full ${getStatusColor(equipment.status)}">
                            ${equipment.status}
                        </span>
                    </td>
                    <td class="px-3 py-2 text-gray-900">${equipment.date}</td>
                </tr>
            `).join('');
            
            previewDiv.classList.remove('hidden');
            updateExportStats();
        }

        function exportFilteredData() {
            const filteredData = getFilteredExportData();
            const format = document.querySelector('input[name="export-format"]:checked').value;
            
            if (filteredData.length === 0) {
                alert('Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ xu·∫•t!');
                return;
            }

            switch(format) {
                case 'excel':
                    exportToExcel(filteredData);
                    break;
                case 'csv':
                    exportToCSV(filteredData);
                    break;
                case 'pdf':
                    exportToPDF(filteredData);
                    break;
            }
        }

        function exportToExcel(data) {
            const headers = ['M√£ thi·∫øt b·ªã', 'T√™n thi·∫øt b·ªã', 'Khoa ph√≤ng', 'Tr·∫°ng th√°i', 'Ng√†y mua', 'Gi√° tr·ªã (VNƒê)'];
            const csvContent = [
                headers.join(','),
                ...data.map(eq => [
                    eq.code,
                    `"${eq.name}"`,
                    `"${eq.department}"`,
                    `"${eq.status}"`,
                    eq.date,
                    eq.value
                ].join(','))
            ].join('\n');
            
            downloadFile(csvContent, 'danh-sach-thiet-bi.csv', 'text/csv');
            alert('ƒê√£ xu·∫•t file Excel th√†nh c√¥ng!');
        }

        function exportToCSV(data) {
            const headers = ['M√£ thi·∫øt b·ªã', 'T√™n thi·∫øt b·ªã', 'Khoa ph√≤ng', 'Tr·∫°ng th√°i', 'Ng√†y mua', 'Gi√° tr·ªã (VNƒê)'];
            const csvContent = [
                headers.join(','),
                ...data.map(eq => [
                    eq.code,
                    `"${eq.name}"`,
                    `"${eq.department}"`,
                    `"${eq.status}"`,
                    eq.date,
                    eq.value
                ].join(','))
            ].join('\n');
            
            downloadFile(csvContent, 'danh-sach-thiet-bi.csv', 'text/csv');
            alert('ƒê√£ xu·∫•t file CSV th√†nh c√¥ng!');
        }

        function exportToPDF(data) {
            // Simulate PDF export
            alert('Ch·ª©c nƒÉng xu·∫•t PDF ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn. Hi·ªán t·∫°i h√£y s·ª≠ d·ª•ng Excel ho·∫∑c CSV!');
        }

        function downloadFile(content, filename, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function quickExport(type) {
            // Reset filters
            document.getElementById('export-department').value = '';
            document.getElementById('export-status').value = '';
            document.getElementById('export-date-from').value = '';
            document.getElementById('export-date-to').value = '';
            
            switch(type) {
                case 'all':
                    // Export all equipment
                    break;
                case 'maintenance':
                    document.getElementById('export-status').value = 'C·∫ßn b·∫£o tr√¨';
                    break;
                case 'broken':
                    document.getElementById('export-status').value = 'H·ªèng h√≥c';
                    break;
                case 'monthly':
                    const today = new Date();
                    const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
                    const lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);
                    document.getElementById('export-date-from').value = firstDay.toISOString().split('T')[0];
                    document.getElementById('export-date-to').value = lastDay.toISOString().split('T')[0];
                    break;
            }
            
            updateExportStats();
            previewExport();
        }

        // Add event listeners for export filters
        document.addEventListener('DOMContentLoaded', function() {
            // Add change listeners to export filters
            ['export-department', 'export-status', 'export-date-from', 'export-date-to'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', updateExportStats);
                }
            });
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            showTab('dashboard');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9893bd00d0e10540',t:'MTc1OTU3MTA0MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
